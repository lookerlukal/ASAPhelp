<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns:m="http://www.w3.org/1998/Math/MathML"><head/><body><span style="padding: 0; font-family: verdana, geneva, sans-serif;font-size: 11px; line-height: 1.50em;     color: #333;  background-color: #fff;"/><html lang="en-us" xml:lang="en-us">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<meta name="copyright" content="(C) Copyright 2005"/>
<meta name="DC.rights.owner" content="(C) Copyright 2005"/>
<meta name="DC.Type" content="topic"/>
<meta name="DC.Title" content="USERBSDF (ASAP Command)"/>
<meta name="abstract" content="Specifies an isotropic or anisotropic scatter model."/>
<meta name="description" content="Specifies an isotropic or anisotropic scatter model."/>
<meta name="DC.subject" content="USERBSDF (ASAP Command), scatter model, isotropic or anisotropic, isotropic scatter model, specifying, anisotropc scatter model, specifying"/>
<meta name="keywords" content="USERBSDF (ASAP Command), scatter model, isotropic or anisotropic, isotropic scatter model, specifying, anisotropc scatter model, specifying"/>
<meta name="DC.Relation" scheme="URI" content="../Reference/Commands_U-ref.html#Commands_and_Macros_U"/>
<meta name="DC.Relation" scheme="URI" content="../Commands/FCN_macro_ASAP-cmdref.html"/>
<meta name="DC.Relation" scheme="URI" content="../Commands/MINMAX_arg_ASAP-cmdref.html"/>
<meta name="DC.Relation" scheme="URI" content="../Commands/MODEL_arg_ASAP-cmdref.html"/>
<meta name="DC.Relation" scheme="URI" content="../Commands/MODELS_ASAP-cmdref.html"/>
<meta name="DC.Relation" scheme="URI" content="../Commands/PARTICLES_ASAP-cmdref.html"/>
<meta name="DC.Relation" scheme="URI" content="../Commands/PIXELS_ASAP-cmdref.html"/>
<meta name="DC.Relation" scheme="URI" content="../Reference/Mathematical_Models_for_Isotropic_Surface_Scattering-ref.html"/>
<meta name="DC.Relation" scheme="URI" content="../Reference/Scatter_Models-ref.html"/>
<meta name="DC.Relation" scheme="URI" content="http://www.breault.com/k-base.php?kbaseID=26"/>
<meta name="DC.Relation" scheme="URI" content="http://www.breault.com/k-base.php?kbaseID=31"/>
<meta name="DC.Relation" scheme="URI" content="http://www.breault.com/k-base.php?kbaseID=24"/>
<meta name="DC.Format" content="XHTML"/>
<meta name="DC.Identifier" content="USERBSDF_ASAP_Command"/>
<link rel="stylesheet" type="text/css" href="../commonltr.css"/>
<title>USERBSDF (ASAP Command)</title>
</head>
<body id="USERBSDF_ASAP_Command"><a name="USERBSDF_ASAP_Command"><!-- --></a>


	<span style="color: #2b6eb5"><h5>USERBSDF (ASAP Command)</h5></span>
	
	
	<div><p>Specifies an isotropic or anisotropic scatter model. </p>

		<p><b>Syntax - Isotropic-surface Scatter Model (user definable)</b>
		</p>

		<pre class="codeblock">
USERBSDF [ fcn ] [ SPATIAL ] c c' c" ... [ PLOT [ a a' ... ] ]
      </pre>

		<br/><table border="0"><thead align="left"><tr style="background-color:#e8f0fb;font-family: verdana, geneva, sans-serif;font-size: 11px"><th><span>Option</span></th><th><span>Description</span></th></tr></thead><tbody><tr style="background-color:#e8f0fb;font-family: verdana, geneva, sans-serif;font-size: 11px"><td><span>
					<p>fcn </p>

				</span></td><td><span>
					<p>FCN function </p>

				</span></td></tr><tr style="background-color:#e8f0fb;font-family: verdana, geneva, sans-serif;font-size: 11px"><td><span>
					<p>SPATIAL </p>

				</span></td><td><span>
					<p>specifies that the local coordinates of the scattering location are passed to
						the FCN function </p>

				</span></td></tr><tr style="background-color:#e8f0fb;font-family: verdana, geneva, sans-serif;font-size: 11px"><td><span>
					<p>c c' c" ... </p>

				</span></td><td><span>
					<p>coefficients </p>

				</span></td></tr><tr style="background-color:#e8f0fb;font-family: verdana, geneva, sans-serif;font-size: 11px"><td><span>
					<p>PLOT </p>

				</span></td><td><span>
					<p>plots the model in log(b-bo) and angle space </p>

				</span></td></tr><tr style="background-color:#e8f0fb;font-family: verdana, geneva, sans-serif;font-size: 11px"><td><span>
					<p>a a' ... </p>

				</span></td><td><span>
					<p>user-defined degree specular angles </p>

				</span></td></tr></tbody></table>
		<p><b>Syntax - Anisotropic-surface Scatter Model</b>
		</p>

		<pre class="codeblock">
USERBSDF X [ fcn ] c c' c'' …
         Y
         Z	
	  :	
      </pre>

		<p><b>Remarks</b>
		</p>

		<p><b>Isotropic-surface Scatter Model</b>
		</p>

		<br/><a name="USERBSDF_ASAP_Command__ul_532E16CBEEC14DB489F0B5B3EDD23A3D"><!-- --></a><ol id="USERBSDF_ASAP_Command__ul_532E16CBEEC14DB489F0B5B3EDD23A3D">
			<li> The <b>FCN</b> function passed to <b>USERBSDF</b> can now
				use the coordinates of the incident ray if <b>SPATIAL</b> is specified.
				The coordinates are expressed in the local coordinates x, y, z of the scattering
				object, stored in high registers. The registers set by <b>SPATIAL</b>
				are therefore, <br/><table border="0"><thead align="left"><tr style="background-color:#e8f0fb;font-family: verdana, geneva, sans-serif;font-size: 11px"><th><span>Register</span></th><th><span>Value</span></th></tr></thead><tbody><tr style="background-color:#e8f0fb;font-family: verdana, geneva, sans-serif;font-size: 11px"><td><span>
							<p>_0 </p>

						</span></td><td><span>
							<p>vacuum wavelength of incident ray </p>

						</span></td></tr><tr style="background-color:#e8f0fb;font-family: verdana, geneva, sans-serif;font-size: 11px"><td><span>
							<p>_1 </p>

						</span></td><td><span>
							<p>U </p>

						</span></td></tr><tr style="background-color:#e8f0fb;font-family: verdana, geneva, sans-serif;font-size: 11px"><td><span>
							<p>_2 </p>

						</span></td><td><span>
							<p>V </p>

						</span></td></tr><tr style="background-color:#e8f0fb;font-family: verdana, geneva, sans-serif;font-size: 11px"><td><span>
							<p>_3 </p>

						</span></td><td><span>
							<p>W </p>

						</span></td></tr><tr style="background-color:#e8f0fb;font-family: verdana, geneva, sans-serif;font-size: 11px"><td><span>
							<p>_64 </p>

						</span></td><td><span>
							<p>x </p>

						</span></td></tr><tr style="background-color:#e8f0fb;font-family: verdana, geneva, sans-serif;font-size: 11px"><td><span>
							<p>_65 </p>

						</span></td><td><span>
							<p>y </p>

						</span></td></tr><tr style="background-color:#e8f0fb;font-family: verdana, geneva, sans-serif;font-size: 11px"><td><span>
							<p>_66 </p>

						</span></td><td><span>
							<p>z </p>

						</span></td></tr></tbody></table></li>

			<li>The intersection point (x, y, z) for <b>SPATIAL</b> is expressed in the
				local coordinates of the scattering object. This facilitates use of a single
				scattering FCN on multiple surfaces. Careful attention to the reference point of the
				surface is required. The z-coordinate is useful for applying scattering models to
				curved surfaces. </li>

			<li>Recall that <b>USERBSDF... PLOT</b> evaluates the TIS using the
				specified user-defined FCN, and that care is therefore required to ensure that the
				user-defined function yields a meaningful 'nominal' function for <b>PLOT</b>. This means that any registers on which FCN depends, other than
				those set by <b>SPATIAL</b>, must be set appropriately before the
					<b>USERBSDF...PLOT</b> command is issued. </li>

			<li id="USERBSDF_ASAP_Command__li_B1D836AACF034AA6BD795EA8D3EF2339"><a name="USERBSDF_ASAP_Command__li_B1D836AACF034AA6BD795EA8D3EF2339"><!-- --></a>Creates, along with a <b>$FCN</b> definition, a user-defined Bi-directional Scattering Distribution
				Function (BSDF) function. </li>

			<li id="USERBSDF_ASAP_Command__li_CB473C2B9CD3484BB757171E2508F5C0"><a name="USERBSDF_ASAP_Command__li_CB473C2B9CD3484BB757171E2508F5C0"><!-- --></a>Up to 63 coefficients c can be used by the
				predefined $FCN function or up to 286 coefficients can be passed to the USERBSDF
				Fortran function. </li>

			<li id="USERBSDF_ASAP_Command__li_7F652FBD7F0A4604B89B3EE0EE0AF925"><a name="USERBSDF_ASAP_Command__li_7F652FBD7F0A4604B89B3EE0EE0AF925"><!-- --></a> If <b>fcn</b> is specified,
				the incident vacuum wavelength and the three isotropic-surface symmetry variables
					<b>(U,V,W)</b> are passed in the variables <b>_0, _1, _2,
				_3</b> registers, the 63 input coefficients <b>c c' …</b> in <b>_4_5 …66</b>. The last entry on the definition is returned as the actual BSDF
				value. If the BSDF is only a function of these variables, scattering from an
				isotropic surface is symmetric with regard to the plane of incidence and surface
				normal. <p>The last entry on the <b>$FCN</b> definition is returned as
					the actual BSDF value. </p>
</li>

			<li id="USERBSDF_ASAP_Command__li_547EE8ED47BB40D2A5F034B8A4F84A48"><a name="USERBSDF_ASAP_Command__li_547EE8ED47BB40D2A5F034B8A4F84A48"><!-- --></a> For example, a BSDF that varies as the
				cosine of the angle from specular raised to some arbitrary power (Phong-like model)
				could be implemented with the following code:
				<pre class="codeblock">
$FCN FONG C=_2+SQRT((1-_1)*(1-_3)), 	!cosine of angle from specular
	            _4*((C&gt;0)^_5)+_6
MODEL; USERBSDF FONG .3 10 .1                                      
</pre>
</li>

			<li id="USERBSDF_ASAP_Command__li_B445A5F4EDFD4C6582B63B04DC988152"><a name="USERBSDF_ASAP_Command__li_B445A5F4EDFD4C6582B63B04DC988152"><!-- --></a> Alternatively, the simplest BSDF model
				with constant Total Integrated Scatter (TIS) that is Lambertian at normal incidence
				but becomes more and more specular as it approaches grazing incidence:
<pre class="codeblock">
$FCN ROUGH _4*(1+_2)/3.1416, 	!_4 will be the TIS
MODEL; USERBSDF ROUGH .9     	!90% TIS
</pre>
<p>Both of these examples, as defined, obey reciprocity (same results occur if _1
					and _3 are interchanged). </p>
</li>

			<li id="USERBSDF_ASAP_Command__li_4699385FA6D3446B9ADADC92082D8307"><a name="USERBSDF_ASAP_Command__li_4699385FA6D3446B9ADADC92082D8307"><!-- --></a> Another example of <b>USERBSDF</b> is the GUERAPV standard model:
<pre class="codeblock">
$FCN GUERAPV C=SQRT(1-_1) A=ACOS(_2+C*SQRT(1-_3)),
A1=_4 B1=_5 C1=_6 D1=_7 A2=_8 B2=_9 C2=_10 D2=_11 D=_12, 
(A1*EXP(-B1*A)*COS(C1*A+D1)+A2*EXP(-B2*A)*COS(C2*A+D2))/C+D/3.1416
MODEL; USERBSDF GUERAPV ...	
</pre>
</li>

			<li id="USERBSDF_ASAP_Command__li_5275E7994ED5401A95F5A1B353AC675C"><a name="USERBSDF_ASAP_Command__li_5275E7994ED5401A95F5A1B353AC675C"><!-- --></a>This is an unphysical model that does not
				obey reciprocity, cannot have the proper directional dependency for smooth surfaces,
				and could even become negative. </li>

			<li id="USERBSDF_ASAP_Command__li_BBB6EDE7976C4F529A557CA8A41E6A5E"><a name="USERBSDF_ASAP_Command__li_BBB6EDE7976C4F529A557CA8A41E6A5E"><!-- --></a>Enter a negative index for particles on a
				reflecting surface. </li>

			<li id="USERBSDF_ASAP_Command__li_4F37CBEF14214782AF1B48372B3C8170"><a name="USERBSDF_ASAP_Command__li_4F37CBEF14214782AF1B48372B3C8170"><!-- --></a> Besides a <b>$FCN</b>
				definition, users can program the <b>USERBSDF</b> routine to return the
				BSDF as a function of the wavelength and isotropic-surface scattering variables. The
				default definition for <b>USERBSDF</b> is the crude APART model for
				scattering from a random collection of homogeneous spherical particles where:
				<pre class="codeblock">
				c  = particle radius divided by wavelength
				c’ = fractional area obscured by particles
				c" = real refractive index of particle (default=100; that is,. opaque)	
				</pre>
</li>

		</ol>

		<p><b>Anisotropic-Surface Scatter Models</b>
		</p>

		<br/><a name="USERBSDF_ASAP_Command__ul_98A9C232E9904D418A8740156C4FCADC"><!-- --></a><ol id="USERBSDF_ASAP_Command__ul_98A9C232E9904D418A8740156C4FCADC">
			<li id="USERBSDF_ASAP_Command__li_27E65B04BF924A8BAF942F7213F3D364"><a name="USERBSDF_ASAP_Command__li_27E65B04BF924A8BAF942F7213F3D364"><!-- --></a>Scattering from anisotropic surfaces is not
				rotationally symmetric at normal incidence and not necessarily symmetric about the
				plane of incidence otherwise. Therefore, the orientation of the model on the surface
				is important and is generally specified by an axis for the second command entry. For
				syntax information, see the command argument, <b>MODEL</b>. </li>

			<li id="USERBSDF_ASAP_Command__li_204EDE49D18F4A0283D9AEE8F9083CA9"><a name="USERBSDF_ASAP_Command__li_204EDE49D18F4A0283D9AEE8F9083CA9"><!-- --></a> The predefined <b>$FCN</b> function can
				use up to 62 coefficients, or up to 286 coefficients can be passed to the USERANIS
				Fortran function. If <b>fcn</b> is specified, the following registers
				are passed: <br/><table border="0"><thead align="left"><tr style="background-color:#e8f0fb;font-family: verdana, geneva, sans-serif;font-size: 11px"><th><span>Registers</span></th><th><span>Data</span></th></tr></thead><tbody><tr style="background-color:#e8f0fb;font-family: verdana, geneva, sans-serif;font-size: 11px"><td><span>_0</span></td><td><span>Incident vacuum wavelength </span></td></tr><tr style="background-color:#e8f0fb;font-family: verdana, geneva, sans-serif;font-size: 11px"><td><span>_1</span></td><td><span> Scatter Alpha direction cosine</span></td></tr><tr style="background-color:#e8f0fb;font-family: verdana, geneva, sans-serif;font-size: 11px"><td><span>_2</span></td><td><span>Scatter Beta direction cosine</span></td></tr><tr style="background-color:#e8f0fb;font-family: verdana, geneva, sans-serif;font-size: 11px"><td><span>_3</span></td><td><span>Specular Alpha direction cosine</span></td></tr><tr style="background-color:#e8f0fb;font-family: verdana, geneva, sans-serif;font-size: 11px"><td><span>_4</span></td><td><span>Specular Beta direction cosine</span></td></tr><tr style="background-color:#e8f0fb;font-family: verdana, geneva, sans-serif;font-size: 11px"><td><span>_5 ... _66</span></td><td><span> c c' c" ... input entries</span></td></tr></tbody></table><p>The last entry on the $FCN definition is returned as the actual
					BSDF value. </p>
</li>

			<li id="USERBSDF_ASAP_Command__li_58AF9582BE1D4140BE9C07522F16E1B4"><a name="USERBSDF_ASAP_Command__li_58AF9582BE1D4140BE9C07522F16E1B4"><!-- --></a> The default definition for <b>USERANIS</b>
				is a simple elliptical Gaussian centered on the specular direction:
				<pre class="codeblock">
	c  = particle radius divided by wavelength
	c’ = fractional area obscured by particles
	c" = real refractive index of particle (default=100; that is, opaque)	
	</pre>
</li>

		</ol>

		<p><b>Both Isotropic and Anisotropic Models:</b>
		</p>

		<br/><a name="USERBSDF_ASAP_Command__ul_7491C101ED4D4A0AB261201A3FB34B6F"><!-- --></a><ol id="USERBSDF_ASAP_Command__ul_7491C101ED4D4A0AB261201A3FB34B6F">
			<li id="USERBSDF_ASAP_Command__li_392F397A7A134170B42A2D354F24C9EF"><a name="USERBSDF_ASAP_Command__li_392F397A7A134170B42A2D354F24C9EF"><!-- --></a>The <b>PLOT</b> option plots
				the model (common base 10 logarithm of the BSDF) for up to seven specular angles in
				ascending order (default 0, 15, 30, 45, 60, 75, 89.9 degrees). The current <b>PIXELS</b> setting controls the resolution of these plots in direction
				cosine space. Creates a distribution file <b>name_angle.dis</b> for each of these
				angles. </li>

			<li id="USERBSDF_ASAP_Command__li_E11DC4297EA34CBD963133374ED662AD"><a name="USERBSDF_ASAP_Command__li_E11DC4297EA34CBD963133374ED662AD"><!-- --></a>The.<b>MINMAX</b> command
				argument may be used to set the minimum and maximum values of the BSDF for this
				specific model. </li>

		</ol>

		<p>
			<a href="/example_scripts.html#USERBSDF">USERBSDF Examples</a>
		</p>

	</div>

	
<div>
<div class="familylinks">
<div class="parentlink"><strong>Parent topic:</strong> <a href="../Reference/Commands_U-ref.html#Commands_and_Macros_U" title="Topics in this section of the Contents tab include ASAP commands and macros that begin with the letter “U”.">Commands and Macros (U)</a></div>
</div>
<div class="relref"><strong>Related reference</strong><br/>
<div><a href="../Reference/Mathematical_Models_for_Isotropic_Surface_Scattering-ref.html" title="Scattering from an isotropic surface must be symmetric with regard to the plane of incidence and surface normal; that is, that scatter pattern does not change when the surface element is rotated about its normal. If the BSDF is only a function of the following variables, these symmetry properties are guaranteed.">Mathematical Models for Isotropic-Surface Scattering</a></div>
<div><a href="../Reference/Scatter_Models-ref.html" title="ASAP supports the scatter models listed in this topic for wide-angle (far from specular) scatter.">Scatter Models</a></div>
</div>
<div class="relinfo"><strong>Related information</strong><br/>
<div><a href="../Commands/FCN_macro_ASAP-cmdref.html" title="Defines new in-line math functions.">$FCN (ASAP Macro)</a></div>
<div><a href="../Commands/MINMAX_arg_ASAP-cmdref.html" title="Sets BSDF bounding.">MINMAX (ASAP Command Argument)</a></div>
<div><a href="../Commands/MODEL_arg_ASAP-cmdref.html" title="Scattering from anisotropic surfaces (for example, brushed, diamond-turned) is not rotationally symmetric at normal incidence, and not necessarily symmetric about the plane of incidence otherwise.">MODEL (ASAP Command Argument)</a></div>
<div><a href="../Commands/MODELS_ASAP-cmdref.html" title="Creates a scattering model.">MODELS (ASAP Command)</a></div>
<div><a href="../Commands/PARTICLES_ASAP-cmdref.html" title="Creates a particulate scatter model.">PARTICLES (ASAP Command)</a></div>
<div><a href="../Commands/PIXELS_ASAP-cmdref.html" title="Sets the resolution for graphics and calculations.">PIXELS (ASAP Command)</a></div>
<div><a href="http://www.breault.com/k-base.php?kbaseID=26" target="_blank">See the Knowledge Base for the technical publication, Coupling Other Software Programs to ASAP for Modeling Nonlinear Optical Components</a></div>
<div><a href="http://www.breault.com/k-base.php?kbaseID=31" target="_blank">See the Knowledge Base for the technical publication, Diffraction Gratings and DOEs ASAP</a></div>
<div><a href="http://www.breault.com/k-base.php?kbaseID=24" target="_blank">See the Knowledge Base for the technical publication, Stray Light Analysis</a></div>
</div>
</div>

</body>
</html></body></html>