<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns:m="http://www.w3.org/1998/Math/MathML"><head/><body><span style="padding: 0; font-family: verdana, geneva, sans-serif;font-size: 11px; line-height: 1.50em;     color: #333;  background-color: #fff;"/><html lang="en-us" xml:lang="en-us">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<meta name="copyright" content="(C) Copyright 2005"/>
<meta name="DC.rights.owner" content="(C) Copyright 2005"/>
<meta name="DC.Type" content="topic"/>
<meta name="DC.Title" content="ROUGHNESS (ASAP Command)"/>
<meta name="abstract" content="Assigns a roughness to the entity of an object, and conserves energy between specular and scattered beams."/>
<meta name="description" content="Assigns a roughness to the entity of an object, and conserves energy between specular and scattered beams."/>
<meta name="DC.subject" content="ROUGHNESS (ASAP Command), object, assigning roughness to entity, auto-correlation length"/>
<meta name="keywords" content="ROUGHNESS (ASAP Command), object, assigning roughness to entity, auto-correlation length"/>
<meta name="DC.Relation" scheme="URI" content="../Reference/Commands_R-ref.html#Commands_and_Macos_R"/>
<meta name="DC.Relation" scheme="URI" content="../Commands/OBJECT_ASAP-cmdref.html"/>
<meta name="DC.Relation" scheme="URI" content="../Concept/BSDF_Fit_Utility_Overview-conc.html"/>
<meta name="DC.Relation" scheme="URI" content="../Concept/Harvey_Model-conc.html"/>
<meta name="DC.Relation" scheme="URI" content="http://www.breault.com/k-base.php?kbaseID=35"/>
<meta name="DC.Format" content="XHTML"/>
<meta name="DC.Identifier" content="ROUGHNESS_ASAP_Command"/>
<link rel="stylesheet" type="text/css" href="../commonltr.css"/>
<title>ROUGHNESS (ASAP Command)</title>
</head>
<body id="ROUGHNESS_ASAP_Command"><a name="ROUGHNESS_ASAP_Command"><!-- --></a>


	<span style="color: #2b6eb5"><h5>ROUGHNESS (ASAP Command)</h5></span>
	
	
	<div><p>Assigns a roughness to the entity of an object, and conserves energy between specular
		and scattered beams. </p>

		<p><b>Syntax</b>
		</p>

		<pre class="codeblock">
ROUGHNESS [ r [ l ] ] [ MODEL  i             [ FRACTION [ f ] ] ]
                        RANDOM h [ s [ m ] ]
      </pre>

		<br/><table border="0"><thead align="left"><tr style="background-color:#e8f0fb;font-family: verdana, geneva, sans-serif;font-size: 11px"><th><span>Option</span></th><th><span>Description</span></th></tr></thead><tbody><tr style="background-color:#e8f0fb;font-family: verdana, geneva, sans-serif;font-size: 11px"><td><span>r</span></td><td><span>RMS micro-roughness</span></td></tr><tr style="background-color:#e8f0fb;font-family: verdana, geneva, sans-serif;font-size: 11px"><td><span>l</span></td><td><span>autocorrelation length</span></td></tr><tr style="background-color:#e8f0fb;font-family: verdana, geneva, sans-serif;font-size: 11px"><td><span>MODEL I</span></td><td><span>specifies BRDF scattering model i</span></td></tr><tr style="background-color:#e8f0fb;font-family: verdana, geneva, sans-serif;font-size: 11px"><td><span>RANDOM</span></td><td><span>flag for height and slope variations</span></td></tr><tr style="background-color:#e8f0fb;font-family: verdana, geneva, sans-serif;font-size: 11px"><td><span>h</span></td><td><span>RMS random height variation</span></td></tr><tr style="background-color:#e8f0fb;font-family: verdana, geneva, sans-serif;font-size: 11px"><td><span>s</span></td><td><span>RMS normal deviations</span></td></tr><tr style="background-color:#e8f0fb;font-family: verdana, geneva, sans-serif;font-size: 11px"><td><span>m</span></td><td><span>probability distribution for normal</span></td></tr></tbody></table>
		<p><b>Remarks</b>
		</p>

		<br/><a name="ROUGHNESS_ASAP_Command__ul_9BFB397EFE2D41D4AA71A51CD95B6A16"><!-- --></a><ol id="ROUGHNESS_ASAP_Command__ul_9BFB397EFE2D41D4AA71A51CD95B6A16">
			<li id="ROUGHNESS_ASAP_Command__li_A1A176C841284373B0456787F035411F"><a name="ROUGHNESS_ASAP_Command__li_A1A176C841284373B0456787F035411F"><!-- --></a>Assigns macroscopic, random height, and
				normal deviations to the object entities. </li>

			<li id="ROUGHNESS_ASAP_Command__li_41DA4BF7D9B443D3B70374B6935D58D8"><a name="ROUGHNESS_ASAP_Command__li_41DA4BF7D9B443D3B70374B6935D58D8"><!-- --></a><b>ROUGHNESS</b>
				<span class="option">r</span> assigns an RMS micro-roughness to object surface(s) in wavelength
				units; use it to transfer energy out of the specularly reflected/refracted beams
				(and usually into any scatter beams) to conserve energy between specular and
				scattered beams. It does not affect the optical path lengths or directions of the
				specular beams. </li>

			<li id="ROUGHNESS_ASAP_Command__li_213E17ABAA1E45BEA46696109461C19A"><a name="ROUGHNESS_ASAP_Command__li_213E17ABAA1E45BEA46696109461C19A"><!-- --></a>If the autocorrelation length <b>l</b> (also in <b>WAVELENGTH</b> units) is given, the effects of
				shadowing at high angles of incidence are included. </li>

			<li> For autocorrelation length, ASAP assumes that any roughness characterized by a
				user-specified RMS value is described by a isotropic, stationary Gaussian process of
				zero mean described by the two-point autocorrelation function of the surface height
				given by <br/><img src="../Equations/ROUGHNESS_equation1.gif"/><br/>where
					<img longdesc="element for autocorrelation length" src="../Equations/ROUGHNESS_equation_element1.gif" width="16" height="26" alt="autocorrelation length"/> is the local deviation of the surface-height from the mean, and the angular
				brackets represent an ensemble average over the surface to which <img longdesc="equation element for ROUGHNESS" src="../Equations/ROUGHNESS_equation_element2.gif" width="16" height="21"/> and
					<img longdesc="equation element for ROUGHNESS" src="../Equations/ROUGHNESS_equation_element3.gif" width="18" height="25"/> are
				confined. The length, <img longdesc="equation element for ROUGHNESS" src="../Equations/ROUGHNESS_equation_element4.gif" width="11" height="23"/>, is
				called the autocorrelation length, sometimes shortened to "correlation length." We
				readily identify <img longdesc="equation element for ROUGHNESS" src="../Equations/ROUGHNESS_equation_element5.gif" width="20" height="18"/> as
				the RMS deviation of surface-height by setting <img longdesc="equation element for ROUGHNESS" src="../Equations/ROUGHNESS_equation_element6.gif" width="51" height="25"/>. We
				also see that the stated properties are satisfied by this form: <br/><table border="0"><thead align="left"/><tbody><tr style="background-color:#e8f0fb;font-family: verdana, geneva, sans-serif;font-size: 11px"><td><span>isotropic</span></td><td><span> Correlation does not vary with azimuth about the normal</span></td></tr><tr style="background-color:#e8f0fb;font-family: verdana, geneva, sans-serif;font-size: 11px"><td><span>stationary</span></td><td><span>Correlation does not vary with position on the surface</span></td></tr><tr style="background-color:#e8f0fb;font-family: verdana, geneva, sans-serif;font-size: 11px"><td><span>zero mean </span></td><td><span>The base surface defines the "average" surface-height</span></td></tr></tbody></table></li>

			<li id="ROUGHNESS_ASAP_Command__li_C97B0A748BAB48A187E9FA20453246C5"><a name="ROUGHNESS_ASAP_Command__li_C97B0A748BAB48A187E9FA20453246C5"><!-- --></a>For a <b>FRACTION f</b>
				(default 1 or given <b>MODEL</b> TIS) of the incident rays, <b>RANDOM</b> or <b>MODEL</b> assigns a macroscopic height
				variation <b>h</b> (defaulted to 0) is a Gaussian distribution with an
				RMS value entered in WAVELENGTH units and slope error s in radians (both defaulted
				to 0) to the surface(s) of the object. The random height variations affect only the
				position of a point on the object and, therefore, the optical path lengths of any
				reflected or refracted beams, while the slope errors affect only the normal (and
				thus the beam directions). </li>

			<li id="ROUGHNESS_ASAP_Command__li_9774CF5BEADB4834B83D7456633374D5"><a name="ROUGHNESS_ASAP_Command__li_9774CF5BEADB4834B83D7456633374D5"><!-- --></a>The<b> RANDOM</b> normal
				deviations <b>s,</b> entered as an RMS value in radians, affect only the
				normal and, therefore, the beam directions. The maximum allowable normal deviation
				is 0.2 radians (for all ASAP products except ASAP lite). If <b>s</b>
				exceeds about one fifth (0.2 radians), then unexpected raytrace results may occur at
				the surface, that is, wrong side warnings may be generated because, for example, a
				ray may randomly reflect into the surface. <div class="note"><span class="notetitle">Note:</span>  The form <b>ROUGHNESS
					RANDOM</b> is obsolescent and is preserved primarily for backward
					compatibility in ASAP. BRO recommends the use of <b>ROUGHNESS
					MODEL</b>. </div>
</li>

			<li id="ROUGHNESS_ASAP_Command__li_8EA5DB85E52F438B83918B4369B17D53"><a name="ROUGHNESS_ASAP_Command__li_8EA5DB85E52F438B83918B4369B17D53"><!-- --></a> For near normal incidence rays, if the RMS
				slope error exceeds about one fifth (.2), unexpected raytrace results may occur at
				the surface; for example, "wrong side" warnings, because a ray may randomly reflect
				or refract into the surface. For near grazing incidence rays, the RMS slope may have
				to be much smaller than this to avoid these raytrace errors. Both errors are, by
				default, generated according to an approximately Gaussian-normal distribution (type
				2 below). However, the slope error distribution function can be any one of the
				following: <br/><table border="0"><thead align="left"><tr style="background-color:#e8f0fb;font-family: verdana, geneva, sans-serif;font-size: 11px"><th><span>m</span></th><th><span>Slope distribution</span></th><th><span>(Maximum/RMS)^2</span></th><th><span> Equivalent</span></th></tr></thead><tbody><tr style="background-color:#e8f0fb;font-family: verdana, geneva, sans-serif;font-size: 11px"><td><span>-3</span></td><td><span>Two deltas</span></td><td><span>1</span></td><td><span> RAN(-15)</span></td></tr><tr style="background-color:#e8f0fb;font-family: verdana, geneva, sans-serif;font-size: 11px"><td><span>-2</span></td><td><span>Lambertian</span></td><td><span/></td><td><span/></td></tr><tr style="background-color:#e8f0fb;font-family: verdana, geneva, sans-serif;font-size: 11px"><td><span>-1</span></td><td><span>Ramp</span></td><td><span>2</span></td><td><span> RAN(-1)</span></td></tr><tr style="background-color:#e8f0fb;font-family: verdana, geneva, sans-serif;font-size: 11px"><td><span>0</span></td><td><span>Uniform</span></td><td><span>3</span></td><td><span>RAN(0)</span></td></tr><tr style="background-color:#e8f0fb;font-family: verdana, geneva, sans-serif;font-size: 11px"><td><span>1</span></td><td><span>Triangular</span></td><td><span>6</span></td><td><span>RAN(2)</span></td></tr><tr style="background-color:#e8f0fb;font-family: verdana, geneva, sans-serif;font-size: 11px"><td><span>2</span></td><td><span>Gaussian-like</span></td><td><span>9</span></td><td><span>RAN(3)</span></td></tr><tr style="background-color:#e8f0fb;font-family: verdana, geneva, sans-serif;font-size: 11px"><td><span>3</span></td><td><span>Cosine</span></td><td><span>5</span></td><td><span>RAN(1)</span></td></tr><tr style="background-color:#e8f0fb;font-family: verdana, geneva, sans-serif;font-size: 11px"><td><span>4</span></td><td><span>Near-Gaussian</span></td><td><span>15</span></td><td><span>RAN(5)</span></td></tr><tr style="background-color:#e8f0fb;font-family: verdana, geneva, sans-serif;font-size: 11px"><td><span>5</span></td><td><span>Gaussian </span></td><td><span> 2 ln (2^32)</span></td><td><span>RAN(15)</span></td></tr></tbody></table></li>

			<li id="ROUGHNESS_ASAP_Command__li_FA121AFB2E0E403FA6EA2A7F5C02A051"><a name="ROUGHNESS_ASAP_Command__li_FA121AFB2E0E403FA6EA2A7F5C02A051"><!-- --></a> To be more precise, if the randomly
				unperturbed normal points along the z axis, the components of the randomly perturbed
				normal are: <p>
					<br/><img src="../Equations/ROUGHNESS_equation2a.gif"/><br/>
				</p>
<p>where <b>u</b> is a uniformly distributed random number, and
						<b>s</b> is a random number determined by the given slope
					distribution (RMS and probability function). </p>
</li>

			<li id="ROUGHNESS_ASAP_Command__li_FD310276155E497FB003593E7A6A0797"><a name="ROUGHNESS_ASAP_Command__li_FD310276155E497FB003593E7A6A0797"><!-- --></a>Note the maximum absolute slope error is
				always limited to one; that is, 45 degrees. </li>

			<li id="ROUGHNESS_ASAP_Command__li_1DB3B81D7987469B8872DE5CC82BD502"><a name="ROUGHNESS_ASAP_Command__li_1DB3B81D7987469B8872DE5CC82BD502"><!-- --></a>Alternatively, the surface slopes may be
				randomized such that the shape of the normal incidence reflected pattern matches
				that of the BRDF specified by the scattering <b>MODEL</b><span class="option">
				i</span>. </li>

		</ol>

		<p>
			<a href="/example_scripts.html#ROUGHNESS">ROUGHNESS Examples</a>
		</p>

	</div>

<div>
<div class="familylinks">
<div class="parentlink"><strong>Parent topic:</strong> <a href="../Reference/Commands_R-ref.html#Commands_and_Macos_R" title="Topics in this section of the Contents tab include ASAP commands and macros that begin with the letter “R”.">Commands and Macros (R)</a></div>
</div>
<div class="relconcepts"><strong>Related concepts</strong><br/>
<div><a href="../Concept/BSDF_Fit_Utility_Overview-conc.html" title="In most instances where it is appropriate to apply the Harvey model or the Polynomial Fit model, you can use the BSDF Fitting utility, which is integrated with ASAP.">BSDF Fit Utility Overview</a></div>
<div><a href="../Concept/Harvey_Model-conc.html" title="Most materials and surface treatments that are used in illumination applications fit the modified Harvey model, or a sum or two Harvey models.">Harvey Model</a></div>
</div>
<div class="relinfo"><strong>Related information</strong><br/>
<div><a href="../Commands/OBJECT_ASAP-cmdref.html" title="Defines an object based upon previously defined entities.">OBJECT (ASAP Command)</a></div>
<div><a href="http://www.breault.com/k-base.php?kbaseID=35" target="_blank">See the Knowledge Base for the technical publication, Stray Light Analysis</a></div>
</div>
</div>

</body>
</html></body></html>