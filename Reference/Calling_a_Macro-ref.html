<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns:m="http://www.w3.org/1998/Math/MathML"><head/><body><span style="padding: 0; font-family: verdana, geneva, sans-serif;font-size: 11px; line-height: 1.50em;     color: #333;  background-color: #fff;"/><html lang="en-us" xml:lang="en-us">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<meta name="copyright" content="(C) Copyright 2005"/>
<meta name="DC.rights.owner" content="(C) Copyright 2005"/>
<meta name="DC.Type" content="reference"/>
<meta name="DC.Title" content="Calling a Macro"/>
<meta name="abstract" content="A macro command is unformatted like all other commands. There can be only one user macro command per input record and it should be the last command on the record. The first entry of a macro command is either a dollar sign &#34;$&#34; or ampersand &#34;&amp;&#34; followed immediately by the macro name. The name can be of any length but only the first 32 characters are significant. The dollar sign &#34;$&#34; causes the program to print the commands in the macro definition after the variables have been replaced by their corresponding arguments. Only the macro command itself is printed when the ampersand &#34;&amp;&#34; is used."/>
<meta name="description" content="A macro command is unformatted like all other commands. There can be only one user macro command per input record and it should be the last command on the record. The first entry of a macro command is either a dollar sign &#34;$&#34; or ampersand &#34;&amp;&#34; followed immediately by the macro name. The name can be of any length but only the first 32 characters are significant. The dollar sign &#34;$&#34; causes the program to print the commands in the macro definition after the variables have been replaced by their corresponding arguments. Only the macro command itself is printed when the ampersand &#34;&amp;&#34; is used."/>
<meta name="DC.Relation" scheme="URI" content="../Concept/ASAP_Macro_Language-conc.html"/>
<meta name="DC.Relation" scheme="URI" content="../Reference/Defining_a_Macro_from_the_Input_Stream-ref.html#Defining_a_Macro_from_the_Input_Stream"/>
<meta name="DC.Relation" scheme="URI" content="../Concept/Internally_Defined_Macros-conc.html#Internally_Defined_Macros"/>
<meta name="DC.Relation" scheme="URI" content="../Reference/User_Defined_Macros-ref.html#User_Defined_Macros"/>
<meta name="DC.Relation" scheme="URI" content="../Task/Increasing_Macro_Command_Execution_Speed-task.html#Increasing_Macro_Command_Execution_Speed"/>
<meta name="DC.Relation" scheme="URI" content="../Reference/Creating_a_Macro_Library_File-ref.html"/>
<meta name="DC.Relation" scheme="URI" content="../Reference/Sharing_Library_Files-ref.html#Sharing_Library_Files"/>
<meta name="DC.Relation" scheme="URI" content="../Commands/PATH_macro_ASAP-cmdref.html"/>
<meta name="DC.Relation" scheme="URI" content="../Commands/SEARCH_macro_ASAP-cmdref.html"/>
<meta name="DC.Format" content="XHTML"/>
<meta name="DC.Identifier" content="Calling_a_Macro"/>
<link rel="stylesheet" type="text/css" href="../commonltr.css"/>
<title>Calling a Macro</title>
</head>
<body id="Calling_a_Macro"><a name="Calling_a_Macro"><!-- --></a>


	<span style="color: #2b6eb5"><h5>Calling a Macro</h5></span>
	
	<div><p>A macro command is unformatted like all other commands. There can be only one user macro command per input record and it should be the last command on the record. The first entry of a macro command is either a dollar sign "$" or ampersand "&amp;" followed immediately by the macro name. The name can be of any length but only the first 32 characters are significant. The dollar sign "$" causes the program to print the commands in the macro definition after the variables have been replaced by their corresponding arguments. Only the macro command itself is printed when the ampersand "&amp;" is used.</p>

		<div class="section" id="Calling_a_Macro__section_A2E2EA8A27CB4822A66224F35F599F35"><a name="Calling_a_Macro__section_A2E2EA8A27CB4822A66224F35F599F35"><!-- --></a>
			<p>The remaining entries on the macro command are the optional arguments to be substituted for the variables in the macro definition. If an argument is not present on the macro command that is referenced in the macro definition, then the program prompts the user for the argument in interactive mode or the variable is replaced with a null entry.</p>

		</div>

		<div class="section" id="Calling_a_Macro__section_7DB9D7E703494E9D9DC34BDF5C23163F"><a name="Calling_a_Macro__section_7DB9D7E703494E9D9DC34BDF5C23163F"><!-- --></a><span style="color: #2b6eb5"><h5>Example</h5></span>
			
			<p>Macro name prefixes (echo,no echo of macro records): $ &amp;</p>

			<p>When the previous example is called, it would be expanded as follows:</p>

			<p>:</p>

			<p>     $NAME 10.02</p>

			<p>-1- SOURCE .01 10.02</p>

			<p>     -1- H 1.01 C 2.01</p>

			<p>     :</p>

			<p>     &amp;NAME</p>

			<p>     Enter collector object number: 5.01</p>

			<p>     :</p>

		</div>

		<div class="section" id="Calling_a_Macro__section_F1543359F79643AC80CA4F513AF591C7"><a name="Calling_a_Macro__section_F1543359F79643AC80CA4F513AF591C7"><!-- --></a><span style="color: #2b6eb5"><h5>Calling a Macro from a Library Other than the Current Library</h5></span>
			
			<p>Normally, the program searches for a macro definition in the currently loaded library (see $IO LIB command). However, this can be overridden on a case-by-case basis using the following syntax:</p>

			<p>                --- library$name ...</p>

			<p>                           &amp;</p>

			<p>where</p>

			<p>"library" is the name of the library file (a .LIB extension will be added) and "name" is the desired macro in that file. </p>

			<p>The program looks for the library file in the following order</p>

			<br/><a name="Calling_a_Macro__ol_3575779834CE42B780674EF0F90616DC"><!-- --></a><ol id="Calling_a_Macro__ol_3575779834CE42B780674EF0F90616DC">
				<li id="Calling_a_Macro__li_CECEFC1BC8944AE38BE90EF8FD223846"><a name="Calling_a_Macro__li_CECEFC1BC8944AE38BE90EF8FD223846"><!-- --></a>current working directory (see $PATH),</li>

				<li id="Calling_a_Macro__li_F40CBEC247AF415E9619B2C5317AA61F"><a name="Calling_a_Macro__li_F40CBEC247AF415E9619B2C5317AA61F"><!-- --></a>$SEARCH path elements, in the order assigned,</li>

				<li id="Calling_a_Macro__li_D099EE3348BE4B47853C9291E02E7F42"><a name="Calling_a_Macro__li_D099EE3348BE4B47853C9291E02E7F42"><!-- --></a>directory containing the last library specified with $IO LIBRARY, if any, and</li>

				<li id="Calling_a_Macro__li_BFD460BC946D4CBD95B0491BA298AAF0"><a name="Calling_a_Macro__li_BFD460BC946D4CBD95B0491BA298AAF0"><!-- --></a>directory specified by the FILES environment variable, on platforms supporting environment variables.</li>

			</ol>

		</div>

	</div>
 
	
<div>
<div class="familylinks">
<div class="parentlink"><strong>Parent topic:</strong> <a href="../Concept/ASAP_Macro_Language-conc.html">ASAP Macro Language</a></div>
</div>
<div class="relconcepts"><strong>Related concepts</strong><br/>
<div><a href="../Concept/Internally_Defined_Macros-conc.html#Internally_Defined_Macros" title="The internally defined macros are contained within the parser (and therefore are always available). These macros give the program looping, input/output redirection, conditional (IF) processing, branching, and other advanced capabilities. Internally defined macros may be used freely in both user-defined macros and general input commands and may appear more than once in a given record.">Internally Defined Macros</a></div>
</div>
<div class="reltasks"><strong>Related tasks</strong><br/>
<div><a href="../Task/Increasing_Macro_Command_Execution_Speed-task.html#Increasing_Macro_Command_Execution_Speed">Increasing Macro Command Execution Speed</a></div>
</div>
<div class="relref"><strong>Related reference</strong><br/>
<div><a href="../Reference/Defining_a_Macro_from_the_Input_Stream-ref.html#Defining_a_Macro_from_the_Input_Stream" title="Instead of defining macros in the library file, you can create individual macro files directly from the input stream. There are two formats, a short or long, respectively:">Defining a Macro from the Input Stream</a></div>
<div><a href="../Reference/User_Defined_Macros-ref.html#User_Defined_Macros" title="User-defined macros can be defined and used within an ASAP input file (*.INR) or defined and placed within a macro library for later use. In either case the syntax is the same.">User-Defined Macros</a></div>
<div><a href="../Reference/Creating_a_Macro_Library_File-ref.html" title="Multiple macro definitions are stored in a library on logical unit 24 by default. Definitions may be created either directly by an ASCII editor or during the decoding of the input by the program.">Creating a Macro Library File</a></div>
<div><a href="../Reference/Sharing_Library_Files-ref.html#Sharing_Library_Files" title="In environments where multiple engineers work together, you may want to share ASAP library files (*.LIB). If the PC's running ASAP are connected via a LAN, two methods in which LIB files can be shared enable you to modify a LIB file so that other staff can use the information.">Sharing Library Files</a></div>
</div>
<div class="relinfo"><strong>Related information</strong><br/>
<div><a href="../Commands/PATH_macro_ASAP-cmdref.html" title="Sets the default directory &#34;path&#34; for future file openings.">$PATH (ASAP Macro)</a></div>
<div><a href="../Commands/SEARCH_macro_ASAP-cmdref.html" title="Provides user control of which paths are searched, and also the order in which paths are searched. These paths are defined and associated with symbolic names. $SEARCH specifies up to 20 paths to be searched for screen (*.scr), macro (*.mac), and macro library (*.lib) files.">$SEARCH (ASAP Macro)</a></div>
</div>
</div>

</body>
</html></body></html>