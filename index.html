<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="description" content="ASAPå…‰å­¦è½¯ä»¶å¸®åŠ©æ–‡æ¡£åº“ï¼ŒåŒ…å«å‘½ä»¤å‚è€ƒå’Œå®ä¾‹åˆ†æ">
    <meta name="keywords" content="ASAP, å…‰å­¦è®¾è®¡, ç…§æ˜è®¾è®¡, å…‰çº¿è¿½è¿¹">
    <meta property="og:type" content="website">
    <meta property="og:title" content="ASAPå¸®åŠ©æ–‡æ¡£ä¸­å¿ƒ">
    <meta property="og:url" content="https://asaphelp.example.com">
    <title>ASAP å¸®åŠ©æ–‡æ¡£</title>
    <meta name="robots" content="index, follow">
    <meta name="googlebot" content="index, follow">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <style>
        body {
            margin: 0;
            padding: 0;
            height: 100vh;
            display: flex;
            font-family: 'Segoe UI', system-ui, sans-serif;
            background: #f8f9fa;
            line-height: 1.6;
        }
        
        /* å·¦ä¾§å¯¼èˆªæ æ ·å¼ */
        #sidebar {
            width: 280px;
            background: #2b303b;
            border-right: 1px solid #dcdde1;
            overflow-y: auto;
            padding: 20px;
            color: #adb5bd;
        }
        
        #sidebar h1 {
            color: #e9ecef;
            font-size: 1.5rem;
            margin-bottom: 1.5rem;
            padding-bottom: 0.5rem;
            border-bottom: 2px solid #4a5568;
        }
        
        /* å³ä¾§å†…å®¹åŒºåŸŸ */
        #content {
            flex: 1;
            padding: 20px;
            background: #ffffff;
        }
        
        iframe {
            width: 100%;
            height: 100%;
            border: none;
            border-radius: 8px;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
        }
        
        /* æ–‡ä»¶åˆ—è¡¨æ ·å¼ä¼˜åŒ– */
        .file-list {
            list-style: none;
            padding: 0;
            margin-top: 1rem;
        }
        .file-item {
            padding: 8px 12px;
            margin: 4px 0;
            border-radius: 6px;
            transition: background 0.3s;
            background: rgba(255,255,255,0.05);
        }
        .file-item:hover {
            background: #4a5568;
        }
        .file-link {
            color: #e9ecef;
            text-decoration: none;
            display: block;
            font-size: 0.9rem;
        }
        
        /* æ·»åŠ å“åº”å¼è®¾è®¡ */
        @media (max-width: 768px) {
            body {
                flex-direction: column;
            }
            #sidebar {
                width: 100%;
                height: 50vh;
                padding: 15px;
            }
            #content {
                height: 50vh;
                padding: 15px;
            }
            #sidebar h1 {
                font-size: 1.5em;
            }
        }

        /* ä»£ç å—æ ·å¼ */
        pre {
            background-color: #f4f4f4;
            padding: 1em;
            border-radius: 4px;
            overflow-x: auto;
        }

        code {
            font-family: 'Consolas', 'Monaco', monospace;
            color: #c7254e;
        }

        .loader {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(255,255,255,0.8);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 1000;
        }
        
        .spinner {
            width: 40px;
            height: 40px;
            border: 4px solid #f3f3f3;
            border-top: 4px solid #3498db;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* æœç´¢æ¡†æ ·å¼ */
        .search-box {
            margin-bottom: 1.5rem;
        }
        
        #searchInput {
            width: 100%;
            padding: 0.5rem 1rem;
            border-radius: 20px;
            border: 1px solid #4a5568;
            background: #343a46;
            color: #e9ecef;
            outline: none;
        }

        #loading {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            text-align: center;
            color: #3498db;
        }
    </style>
    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "TechnicalArticle",
      "name": "ASAPå¸®åŠ©æ–‡æ¡£ä¸­å¿ƒ",
      "description": "ASAPå…‰å­¦è½¯ä»¶å¸®åŠ©æ–‡æ¡£åº“ï¼ŒåŒ…å«å‘½ä»¤å‚è€ƒå’Œå®ä¾‹åˆ†æ",
      "articleSection": ["å‘½ä»¤å‚è€ƒ", "å®ä¾‹åˆ†æ"],
      "keywords": "ASAP, å…‰å­¦è®¾è®¡, ç…§æ˜è®¾è®¡, å…‰çº¿è¿½è¿¹"
    }
    </script>
</head>
<body>
    <div id="sidebar">
        <h1>ASAP æ–‡æ¡£ä¸­å¿ƒ</h1>
        <nav aria-label="æ–‡æ¡£åˆ†ç±»å¯¼èˆª">
            <div class="search-box">
                <input type="text" id="searchInput" placeholder="æœç´¢æ–‡æ¡£...">
            </div>
            <h2>å‘½ä»¤å‚è€ƒ</h2>
            <div id="commandsList"></div>
            <h2>å®ä¾‹åˆ†æ</h2>
            <div id="examplesList"></div>
        </nav>
        <div id="fileList"></div>
    </div>
    <div id="content">
        <iframe id="contentFrame" name="contentFrame"></iframe>
    </div>

    <div id="loading" style="display:none;">
        <div class="spinner"></div>
        <p>æ­£åœ¨åŠ è½½æ–‡ä»¶...</p>
    </div>

    <script>
        // åŠ¨æ€åŠ è½½é…ç½®æ–‡ä»¶
        let siteStructure = null;

        // ä¸´æ—¶ä½¿ç”¨XMLHttpRequestæ›¿ä»£fetch
        const xhr = new XMLHttpRequest();
        xhr.open('GET', 'site-config.json');
        xhr.onload = function() {
            if (xhr.status === 200) {
                const config = JSON.parse(xhr.responseText);
                console.log('é…ç½®ç»“æ„éªŒè¯:', {
                    isValid: !!config?.siteStructure?.children,
                    childrenCount: config?.siteStructure?.children?.length || 0
                });
                siteStructure = config.siteStructure;
                document.getElementById('fileList').innerHTML = buildFileList(siteStructure);
                console.log('æ¸²æŸ“å®Œæˆï¼ŒDOMå†…å®¹é•¿åº¦:', document.getElementById('fileList').innerHTML.length);
            }
        };
        xhr.send();

        function buildFileList(node, path = '') {
            let html = '<ul class="file-list">';
            for (const item of node.children) {
                const encodedName = encodeURIComponent(item.name);
                const currentPath = path ? 
                    `${path}/${encodedName}`.replace(/\/{2,}/g, '/') : 
                    encodedName;

                if (item.type === 'file') {
                    const isINR = item.name.toLowerCase().endsWith('.inr');
                    html += `
                        <li class="file-item">
                            <a href="${currentPath}" 
                               class="file-link ${isINR ? 'inr-file' : ''}" 
                               target="contentFrame"
                               data-filepath="${currentPath}">
                                ğŸ“„ ${item.name}
                            </a>
                            <noscript>
                                <a href="${currentPath}">${item.name}</a>
                            </noscript>
                        </li>
                    `;
                } else if (item.type === 'directory') {
                    html += `<li class="directory" aria-label="ç›®å½•: ${item.name}">`;
                    html += `<h3 class="directory-name">${item.name}</h3>`;
                    html += buildFileList(item, currentPath);
                    html += '</li>';
                }
            }
            html += '</ul>';
            return html;
        }

        // å³æ—¶æœç´¢åŠŸèƒ½
        document.getElementById('searchInput').addEventListener('input', function(e) {
            const query = e.target.value.toLowerCase();
            document.querySelectorAll('.file-item').forEach(item => {
                const text = item.textContent.toLowerCase();
                item.style.display = text.includes(query) ? 'block' : 'none';
            });
        });

        document.getElementById('fileList').addEventListener('click', async (e) => {
            const link = e.target.closest('.inr-file');
            if (link) {
                e.preventDefault();
                const filePath = link.dataset.filepath;
                
                document.getElementById('loading').style.display = 'block';
                
                try {
                    const response = await fetch(filePath);
                    const text = await response.text();
                    const contentDiv = document.createElement('div');
                    contentDiv.style.display = 'none';
                    contentDiv.innerHTML = text;
                    document.body.appendChild(contentDiv);
                    
                    document.getElementById('contentFrame').srcdoc = `
                        <pre>${text}</pre>
                        <style>
                            body {
                                margin: 0;
                                padding: 20px;
                                font-family: Consolas, monospace;
                                white-space: pre-wrap;
                                background: #f8f9fa;
                            }
                        </style>
                    `;
                } catch (error) {
                    console.error('æ–‡ä»¶åŠ è½½å¤±è´¥:', error);
                    document.getElementById('contentFrame').srcdoc = `
                        <div style="color: red; padding: 20px;">
                            æ— æ³•åŠ è½½æ–‡ä»¶: ${filePath}
                        </div>
                    `;
                } finally {
                    document.getElementById('loading').style.display = 'none';
                }
            }
        });

        // åœ¨åˆå§‹åŒ–å‡½æ•°åæ·»åŠ INRæ–‡ä»¶å¤„ç†
        document.getElementById('contentFrame').addEventListener('load', function() {
            if(this.contentDocument.body.innerText.includes('INR File Content')) {
                this.contentDocument.body.style.whiteSpace = 'pre-wrap';
                this.contentDocument.body.style.fontFamily = 'Consolas, monospace';
            }
        });
    </script>

    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "CollectionPage",
      "name": "ASAPæ–‡æ¡£åº“",
      "description": "åŒ…å«ASAPè½¯ä»¶çš„æ‰€æœ‰å‘½ä»¤å‚è€ƒå’Œå®ä¾‹åˆ†ææ–‡æ¡£",
      "hasPart": [
        // è‡ªåŠ¨ç”Ÿæˆæ–‡æ¡£åˆ—è¡¨
        ...siteStructure.children.map(doc => ({
          "@type": "TechArticle",
          "name": doc.name,
          "url": location.href + doc.path,
          "fileFormat": doc.name.split('.').pop()
        }))
      ]
    }
    </script>
</body>
</html>
